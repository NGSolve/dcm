
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>2.2. Introduction &#8212; The Dual Cell Method in NGSolve</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=384b581d" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/proof.css?v=ca93fcec" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css?v=0a3b3ea7" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae" />
  <script src="../_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=8d27b9dea8ad943066ae"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=efea14e4"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=36754332"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'maxwell/introduction';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="2.3. Discrete spaces on dual cells" href="hcurl.html" />
    <link rel="prev" title="2. The dual cell method for the time-domain Maxwell system" href="../maxwell.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <header class="bd-header navbar navbar-expand-lg bd-navbar">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.png" class="logo__image only-light" alt="The Dual Cell Method in NGSolve - Home"/>
    <script>document.write(`<img src="../_static/logo.png" class="logo__image only-dark" alt="The Dual Cell Method in NGSolve - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    The Dual Cell Method in NGSolve
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../installation.html">1. Installation</a></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../maxwell.html">2. The dual cell method for the time-domain Maxwell system</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2 current active"><a class="current reference internal" href="#">2.2. Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="hcurl.html">2.3. Discrete spaces on dual cells</a></li>
<li class="toctree-l2"><a class="reference internal" href="mass_lumping.html">2.4. Mass lumping</a></li>
<li class="toctree-l2"><a class="reference internal" href="diffops.html">2.5. The discrete differential operators</a></li>
<li class="toctree-l2"><a class="reference internal" href="time_stepping.html">2.6. Time stepping</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../examples.html">3. Examples</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../examples/qualitative_dispersion.html">3.1. A plane wave on a square</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/ring_resonator.html">3.2. Ring resonator</a></li>
</ul>
</li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/ngsolve/dcm" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/ngsolve/dcm/issues/new?title=Issue%20on%20page%20%2Fmaxwell/introduction.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/maxwell/introduction.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Introduction</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reasons-for-explicit-methods">Reasons for explicit methods</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#scattering-type-problems">scattering type problems</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#resonance-type-problems">resonance type problems</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#state-of-the-art">State of the art</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#from-fdtd-to-the-dual-cell-method">From FDTD to the dual cell method</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#basic-idea-of-the-dual-cell-construction">Basic idea of the dual cell construction</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#galerkin-setting-and-high-order-spaces">Galerkin setting and high order spaces</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="introduction">
<span id="id1"></span><h1><span class="section-number">2.2. </span>Introduction<a class="headerlink" href="#introduction" title="Link to this heading">#</a></h1>
<p>When solving time-domain wave-type problems using a <a class="reference external" href="https://en.wikipedia.org/wiki/Method_of_lines">method of lines</a> approach one typically has the choice between <em>implicit</em> and <em>explicit</em> methods. For the former in each time-step the inverse of a system matrix composed of the mass matrix and the discrete differential operator has to be applied. Although such schemes are typically unconditionally stable (independent of the choice of the time-step) the factorization of a large matrix does not scale well for very large numbers of degrees of freedom.</p>
<p>For explicit methods, on the other hand in each time-step merely the inverse mass matrix has to be applied. There exist several methods to make the mass matrix as convenient for inversion as possible. The downside of explicit methods is the fact that their stability depends on the quality of the discretization, i.e., the finer the discretization, the finer is the largest admissible time-step that guarantees stability.</p>
<section id="reasons-for-explicit-methods">
<h2>Reasons for explicit methods<a class="headerlink" href="#reasons-for-explicit-methods" title="Link to this heading">#</a></h2>
<p>Apart from the obvious better scaling for very large applications, explicit time-domain solvers are also interesting for frequency-domain applications:</p>
<section id="scattering-type-problems">
<h3>scattering type problems<a class="headerlink" href="#scattering-type-problems" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>time-domain solvers for Helmholtz (2020s e.g., <span id="id2">[]</span>)</p></li>
<li><p>time-domain preconditioners (2020s, e.g., <span id="id3">[]</span> )</p></li>
</ul>
</section>
<section id="resonance-type-problems">
<h3>resonance type problems<a class="headerlink" href="#resonance-type-problems" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>explicit eigenvalue solvers lite PINVIT, LOBPCG (early 2000s, e.g., <span id="id4">[]</span> )</p></li>
<li><p>time-domain filters for eigenvalue problems (very recent  <span id="id5">[]</span>)</p></li>
</ul>
</section>
</section>
<section id="state-of-the-art">
<h2>State of the art<a class="headerlink" href="#state-of-the-art" title="Link to this heading">#</a></h2>
<p>The most popular explicit methods are</p>
<div class="sd-card sd-sphinx-override sd-mb-3 sd-shadow-sm docutils">
<div class="sd-card-header docutils">
<p class="sd-card-text">Finite Difference Time Domain (FDTD) Methods</p>
</div>
<div class="sd-card-body docutils">
<ul class="simple">
<li><p class="sd-card-text">2e5 hits on Google scholar, 1.2e4 since 2022</p></li>
<li><p class="sd-card-text">low order</p></li>
<li><p class="sd-card-text">only hexahedral grids</p></li>
</ul>
</div>
</div>
<div class="sd-card sd-sphinx-override sd-mb-3 sd-shadow-sm docutils">
<div class="sd-card-header docutils">
<p class="sd-card-text">Discontinuous Galerkin (DG) Methods</p>
</div>
<div class="sd-card-body docutils">
<ul class="simple">
<li><p class="sd-card-text">1.5e4 hits on Google scholar, 1.6e3 since 2022</p></li>
<li><p class="sd-card-text">high order</p></li>
<li><p class="sd-card-text">necessary choice of numerical fluxes, penalty parameter</p></li>
</ul>
</div>
</div>
<p>While both of these methods have been around since the late 1960’s  and early 1970’s FDTD is still most widely used in engineering applications.</p>
</section>
<section id="from-fdtd-to-the-dual-cell-method">
<h2>From FDTD to the dual cell method<a class="headerlink" href="#from-fdtd-to-the-dual-cell-method" title="Link to this heading">#</a></h2>
<p>The main idea of the FDTD methods is the discretization of Stokes’ theorem.</p>
<figure class="align-default" id="stokes">
<a class="reference internal image-reference" href="../_images/stokes.png"><img alt="../_images/stokes.png" src="../_images/stokes.png" style="height: 400px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 2.1 </span><span class="caption-text">A visualization of Stokes’ theorem.</span><a class="headerlink" href="#stokes" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>This leads to discrete quantities on interlaced hexahedral grids.</p>
<figure class="align-default" id="stokes-disc">
<a class="reference internal image-reference" href="../_images/stokes_disc.png"><img alt="../_images/stokes_disc.png" src="../_images/stokes_disc.png" style="height: 400px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 2.2 </span><span class="caption-text">Discrete, pointwise approximations mimmicking Stokes’ theorem.</span><a class="headerlink" href="#stokes-disc" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p><span class="math notranslate nohighlight">\(h^l_{i,j,k},e^l_{i,j,k}\)</span> are point values of the fields at points <span class="math notranslate nohighlight">\((x_i,y_j,z_k)\)</span> (tangential to the staggered grid) at timestep number <span class="math notranslate nohighlight">\(l\)</span> and satisfy</p>
<div class="math notranslate nohighlight">
\[\begin{split}\partial_t h_{i+\tfrac{1}{2},j+\tfrac{1}{2},k}&amp;\approx e_{i+\tfrac{1}{2},j,k}-e_{i+1,j+\tfrac{1}{2},k}-e_{i+\tfrac{1}{2},j+1,k}+e_{i,j+\tfrac{1}{2},k}\\
\partial_t e_{i+\tfrac{1}{2},j+\tfrac{1}{2},k}&amp;\approx h_{i+\tfrac{1}{2},j+\tfrac{1}{2},k}-h_{i,j+\tfrac{1}{2},k+\tfrac{1}{2}}-h_{i-\tfrac{1}{2},j+\tfrac{1}{2},k}-h_{i,j+\tfrac{1}{2},k-\tfrac{1}{2}}\end{split}\]</div>
<p>The time discretization is done using a <a class="reference external" href="https://en.wikipedia.org/wiki/Leapfrog_integration">Leap-Frog</a> time-stepping with time-step size <span class="math notranslate nohighlight">\(\tau\)</span>,</p>
<div class="math notranslate nohighlight">
\[\partial_t h^{l}_{i,j,k}\approx \frac{h_{i,j,k}^{l+\tfrac{1}{2}}-h_{i,j,k}^{l-\tfrac{1}{2}}}{\tau},\quad\quad\quad\partial_t e^{l+\tfrac{1}{2}}_{i,j,k}\approx \frac{e_{i,j,k}^{l+1}-e_{i,j,k}^{l}}{\tau}\]</div>
<p>which carries the idea of the interlaced grid to time-domain.</p>
<div class="sd-card sd-sphinx-override sd-mb-3 sd-shadow-sm docutils">
<div class="sd-card-header docutils">
<p class="sd-card-text">Goal of the dual cell method</p>
</div>
<div class="sd-card-body docutils">
<p class="sd-card-text">generalize FDTD to</p>
<ul class="simple">
<li><p class="sd-card-text">high order Galerkin method</p></li>
<li><p class="sd-card-text">on general (tetrahedral) grids</p></li>
</ul>
</div>
</div>
</section>
<section id="basic-idea-of-the-dual-cell-construction">
<h2>Basic idea of the dual cell construction<a class="headerlink" href="#basic-idea-of-the-dual-cell-construction" title="Link to this heading">#</a></h2>
<p>For motivation of the construction of the basis functions and spaces we start by focussing on the two dimensional problem.</p>
<figure class="align-default" id="fdtd-2d">
<a class="reference internal image-reference" href="../_images/fdtd_2d.png"><img alt="../_images/fdtd_2d.png" src="../_images/fdtd_2d.png" style="height: 400px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 2.3 </span><span class="caption-text">Going to two dimensions.</span><a class="headerlink" href="#fdtd-2d" title="Link to this image">#</a></p>
</figcaption>
</figure>
<section id="galerkin-setting-and-high-order-spaces">
<h3>Galerkin setting and high order spaces<a class="headerlink" href="#galerkin-setting-and-high-order-spaces" title="Link to this heading">#</a></h3>
<p>Interpreting the scalar point values (orange circles) as piecewise constant basis functions on each element <span class="math notranslate nohighlight">\(\mathbf C\)</span> (dark grey, consisting of four cells) we may proceed from a finite difference setting, to a Galerkin setting.</p>
<p>For the vectorial unknowns the degrees of freedom are the inner tangential components between two neighbouring cells. The respective basis functions are tangentially continuous on each dual element <span class="math notranslate nohighlight">\(\tilde {\mathbf C}\)</span> (again consisting of four cells).</p>
<figure class="align-default" id="primal-dual-quad">
<a class="reference internal image-reference" href="../_images/primal_dual_quad.png"><img alt="../_images/primal_dual_quad.png" src="../_images/primal_dual_quad.png" style="height: 400px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 2.4 </span><span class="caption-text">primal and dual quad-meshes</span><a class="headerlink" href="#primal-dual-quad" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>Thus if the primal and dual elements are given by</p>
<div class="math notranslate nohighlight">
\[\begin{split}\mathbf C_j&amp;=\bigcup_{k=0}^3 C_{k(j)}\in\mathcal C\\
\tilde {\mathbf C}_j&amp;=\bigcup_{k=0}^3 C_{\tilde k(j)} \in \tilde{\mathcal C},\end{split}\]</div>
<p>we may define the local high order spaces</p>
<div class="math notranslate nohighlight">
\[\begin{split}\mathcal W_{\mathbf C_j} &amp;= \{H: \mathbf C_j\to \mathbb R : H|_{C_{k(j)}}\in Q^p\quad\forall k, H \text{ is cont.}\}, \\
\mathcal V_{\tilde{\mathbf C}_j} &amp;= \{E: \tilde{\mathbf  C}_j\to \mathbb R^2 : E|_{C_{\tilde k(j)}}\in \left(Q^p\right)^2\quad\forall \tilde k, E\cdot\tau \text{ is cont.}\}.\end{split}\]</div>
<p>The global spaces are then given by <span class="math notranslate nohighlight">\(\mathcal W = \bigcup_{\mathbf C\in \mathcal C}\mathcal W_{\mathbf C}\)</span>, <span class="math notranslate nohighlight">\(\mathcal V = \bigcup_{\tilde{\mathbf C}\in \tilde{\mathcal C}}\mathcal W_{\tilde{\mathbf C}}\)</span> where the basis functions are set to zero outside of their original domain.</p>
<p>Using these spaces we may pose the semi-discrete (ultra) weak form to find <span class="math notranslate nohighlight">\(\mathbf E :[0,T]\to\mathcal V\)</span>, <span class="math notranslate nohighlight">\(H:[0,T]\to\mathcal W\)</span> such that</p>
<div class="sd-card sd-sphinx-override sd-mb-3 sd-shadow-sm docutils">
<div class="sd-card-body docutils">
<div class="math notranslate nohighlight">
\[\begin{split}\partial_t \left(\varepsilon\mathbf{E},\hat{\mathbf{E}}\right)_{L^2(\Omega)}
-\sum_{{\mathbf C}\in{\mathcal C}}\left(\mathrm{rot} H,\hat{\mathbf{E}}\right)_{L^2({\mathbf C})}+\left(H,\hat{\mathbf{E}}\cdot\tau\right)_{L^2(\partial{\mathbf C})}=0,\quad \forall \hat {\mathbf{E}}\in\mathcal V\\
\partial_t \left(\mu H,\hat H\right)_{L^2(\Omega)}+\sum_{{\mathbf C}\in{\mathcal C}}\left(\mathbf{E},\mathrm{rot} \hat H\right)_{L^2({\mathbf C})}-\left(\mathbf{E}\cdot\tau,\hat H\right)_{L^2(\partial{\mathbf C})}=0,\quad \forall \hat H\in\mathcal W.\end{split}\]</div>
</div>
</div>
<p>This variational formulation has the following remarkable features:</p>
<ul class="simple">
<li><p>The boundary terms arise due to the fact that our discrete spaces have discontinuities on the boundaries of the primal/dual elements respectively. However differing from DG methods across each element boundary one of the fields is (tangentially) continuous.</p></li>
<li><p>We used integration by parts to only have boundary terms on the primal elements in the formulation which helps with implementation.</p></li>
<li><p>Due to skew-symmetry we immediately obtain energy conservation of the semi-discrete system.</p></li>
</ul>
<p>It remains to construct a high-order basis (on simplexes) for these spaces. This will be done in the following section.</p>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./maxwell"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="../maxwell.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">2. </span>The dual cell method for the time-domain Maxwell system</p>
      </div>
    </a>
    <a class="right-next"
       href="hcurl.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">2.3. </span>Discrete spaces on dual cells</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reasons-for-explicit-methods">Reasons for explicit methods</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#scattering-type-problems">scattering type problems</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#resonance-type-problems">resonance type problems</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#state-of-the-art">State of the art</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#from-fdtd-to-the-dual-cell-method">From FDTD to the dual cell method</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#basic-idea-of-the-dual-cell-construction">Basic idea of the dual cell construction</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#galerkin-setting-and-high-order-spaces">Galerkin setting and high order spaces</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By M. Wess
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>